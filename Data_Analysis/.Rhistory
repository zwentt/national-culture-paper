interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "sensing2"
for (var in glo_p) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + y2013std + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
#Control Variable Models
for (dv in agility2Measures) {
print("----------------------------------------------------------------------")
print(dv)
print("----------------------------------------------------------------------")
controlVarModel <- eval(paste(dv, " ~ ", "firmsizestd + network2xcj + y2013std + I(firmsizestd*firmsizestd) + (1 | countryx) ", sep = ""))
controlVarModel.fit <- lmer(controlVarModel, data = CultureData, REML = FALSE)
print(summary(controlVarModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(controlVarModel.fit), "df"))
}
dv <- "proactive2"
for (var in glo_p) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + y2013std + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "proactive2"
for (var in glo_v) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + y2013std + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "sensing2"
for (var in glo_v) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + y2013std + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "agility2"
for (var in glo_v) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + y2013std + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
plot(agility2 outcome)
plot(CultureData$agility2 CultureData$outcome)
plot(CultureData$agility2, CultureData$outcome)
plot(CultureData$agility2, CultureData$outcome2)
plot(CultureData$agility2, CultureData$outcome)
plot(CultureData$agility, CultureData$outcome)
table countryx pickone
table CultureData$countryx CultureData$pickone
table CultureData$countryx
table(CultureData$countryx)
table(CultureData$country)
table(CultureData$country)
CultureData <- read_dta("D:/OneDrive - University of Toledo/Desktop/@ National Culture/CultureData.dta")
culturalMeasures = c("guaip", "gfuop", "gpdip", "ginscolp", "ghump", "gpefp", "gigrcolp", "ggndp", "gassp",
"guaiv", "gfuov", "gpdiv", "ginscolv", "ghumv", "gperv", "gigrcolv", "ggndv", "gassv",
"pdi", "idv", "lto", "ivr", "mas", "uai")
hof = c("pdi", "idv", "lto", "ivr", "mas", "uai")
glo_v = c("guaiv", "gfuov", "gpdiv", "ginscolv", "ghumv", "gperv", "gigrcolv", "ggndv", "gassv")
glo_p = c("guaip", "gfuop", "gpdip", "ginscolp", "ghump", "gpefp", "gigrcolp", "ggndp", "gassp")
agilityMeasures = c("sensing", "proactive", "agility")
agility2Measures = c("sensing2", "proactive2", "agility2")
outcomeMeasures = c("flexOutcome", "speedOutcome", "outcome")
outcome2Measures = c("flexOutcome2", "speedOutcome2", "outcome2")
ls(CultureData)
#Control Variable Models
for (dv in agility2Measures) {
print("----------------------------------------------------------------------")
print(dv)
print("----------------------------------------------------------------------")
controlVarModel <- eval(paste(dv, " ~ ", "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd) + (1 | countryx) ", sep = ""))
controlVarModel.fit <- lmer(controlVarModel, data = CultureData, REML = FALSE)
print(summary(controlVarModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(controlVarModel.fit), "df"))
}
dv <- "agility2"
for (var in glo_v) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "agility2"
for (var in hof) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "sensing2"
for (var in hof) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
dv <- "proactive2"
for (var in hof) {
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
interceptModel <- eval(paste(dv, " ~ ", paste(culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
#interceptModel <- eval(paste(dv, " ~ ", culc, " + ", "firmsizestd + network2xcj + log10(y2013) + I(firmsizestd*firmsizestd) + (", culc,  " | countryx)", sep = ""))
print("start")
interceptModel.fit <- lmer(interceptModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(interceptModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(interceptModel.fit), "df"))
}
corr(y2013 gmci2013 gmci2016)
corr(y2013, gmci2013, gmci2016)
cor(y2013, gmci2013, gmci2016)
help(corr)
attach(CultureData)
cor(y2013, gmci2013, gmci2016)
corr(y2013, gmci2013, gmci2016)
corr(y2013, gmci2013)
corr(CultureData$y2013, CultureData$gmci2013)
dettach(CultureData)
attach(CultureData)
corr(y2013, gmci2013)
corr(c(y2013, gmci2013))
plot(y2013, gmci2013)
plot(y2013, gmci2016)
plot(gmci2013, gmci2016)
lm(gmci2013 ~ gmci2016)
summary(lm(gmci2013 ~ gmci2016))
detach(CultureData)
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
slopeModel
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
outcome <- "outcome2"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
crossInteraction
tri.crossInteraction <- paste("I(", culc, "*network2xcj*network2xcj)", sep = "")
tri.crossInteraction
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
outcome <- "outcome2"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*network2xcj)", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*network2xcj)", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel
outcome <- "outcome2"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome2"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome2"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, "gmci2016c | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " + gmci2016c | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in hof) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " + y2013std | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
outcome <- "outcome"
for (var in glo_v) {
iv <- "agility2"
culc <- paste(var, "_c", sep = "")
controlVar <- "firmsizestd + network2xcj + gmci2016c + I(firmsizestd*firmsizestd)"
crossInteraction <- paste("I(", culc, "*", iv, ")", sep = "")
tri.crossInteraction <- paste("I(", culc, "*network2xcj*", iv, ")", sep = "")
randomEffect <- paste("(", culc, " + y2013std | countryx)", sep = "")
slopeModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, randomEffect, sep = " + ")))
y.crossModel <- eval(paste(dv, " ~ ", paste(iv, culc, controlVar, crossInteraction, tri.crossInteraction, randomEffect, sep = " + ")))
y.crossModel.fit <- lmer(y.crossModel, data = CultureData, REML = FALSE,
#control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'))
control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
print(summary(y.crossModel.fit))
print("Number of parameters estimated: ")
print(attr(logLik(y.crossModel.fit), "df"))
}
library(haven)
library(lme4)
library(blme)
library(lmerTest)
library(dplyr)
library(data.table)
library(sjstats)
library(lmtest)
library(readr)
library(ggplot2)
library(extrafont)
library(margins)
options(scipen=999)
#Reading data from Windows 10
CultureData <- read_dta("D:/OneDrive - University of Toledo/Desktop/@ National Culture/national-culture-paper/Data_Analysis/CultureData.dta")
#Path to save output files
filepath <- "D:/OneDrive - University of Toledo/Desktop/@ National Culture/national-culture-paper/Data_Analysis/"
#Work directory
setwd(filepath)
culturalMeasures = c("guaip", "gfuop", "gpdip", "ginscolp", "ghump", "gpefp", "gigrcolp", "ggndp", "gassp",
"guaiv", "gfuov", "gpdiv", "ginscolv", "ghumv", "gperv", "gigrcolv", "ggndv", "gassv",
"pdi", "idv", "lto", "ivr", "mas", "uai")
hof = c("pdi", "idv", "lto", "ivr", "mas", "uai")
glo_v = c("guaiv", "gfuov", "gpdiv", "ginscolv", "ghumv", "gperv", "gigrcolv", "ggndv", "gassv")
glo_p = c("guaip", "gfuop", "gpdip", "ginscolp", "ghump", "gpefp", "gigrcolp", "ggndp", "gassp")
agilityMeasures = c("sensing", "proactive", "agility")
agility2Measures = c("sensing2", "proactive2", "agility2")
outcomeMeasures = c("flexOutcome", "speedOutcome", "outcome")
outcome2Measures = c("flexOutcome2", "speedOutcome2", "outcome2")
allMeasures = c("sensing2", "proactive2", "agility2", "flexOutcome", "speedOutcome", "outcome")
#Define a function to return a star or stars according to their signifcance
sigStar <- function(tval)  {
if (abs(tval) <= abs(qt(.05, df = 30)))  # critical t = 1.697261
" "
else if (abs(tval) <= abs(qt(.025, df = 30))) # critical t = 2.042272
"+"
else if ((abs(tval) <= abs(qt(.005, df = 30)))) # critical t = 2.749996
"*"
else if ((abs(tval) <= abs(qt(.0005, df = 30)))) # critical t = 3.645959
"**"
else
"***"
}
vars <- c("firmsizestd", "gmci2016c", "I(firmsizestd*firmsizestd)", "(1 | countryx)")
vars_incld <- ""
for (var in vars) {
vars_incld <- paste(vars_incld, var, sep = " + ")
}
vars_incld <- substr(vars_incld, 4, 4000)
o.controlVarModel <- eval(paste(dv, " ~ ", vars_incld, sep = ""))
o.controlVarModel
ls(CultureData)
lmer(outcome ~ firmsizestd + gmci2016c + gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c + sensing2 + proactive2 + I(firmsizestd*firmsizestd) + (gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c | countryx), data = CultureData)
superModel <- outcome ~ firmsizestd + gmci2016c + gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c + sensing2 + proactive2 + I(firmsizestd*firmsizestd) + (gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c | countryx)
superModel.fit <- blmer(superModel, data = CultureData, REML = FALSE, control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
superModel <- outcome ~ firmsizestd + gmci2016c + gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c + sensing2 + proactive2 + I(firmsizestd*firmsizestd) + gassv_c*sensing2 + gfuov_c*sensing2 + ggndv_c*sensing2 + ghumv_c*sensing2 + gigrcolv_c*sensing2 + ginscolv_c*sensing2 + gpdiv_c*sensing2 + gperv_c*sensing2 + guaiv_c*sensing2 + gassv_c*proactive2 + gfuov_c*proactive2 + ggndv_c*proactive2 + ghumv_c*proactive2 + gigrcolv_c*proactive2 + ginscolv_c*proactive2 + gpdiv_c*proactive2 + gperv_c*proactive2 + guaiv_c*proactive2 + (gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c | countryx)
superModel.fit <- blmer(superModel, data = CultureData, REML = FALSE, control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
superModel2 <- outcome ~ firmsizestd + gmci2016c + gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c + agility2 + gassv_c*agility2 + gfuov_c*agility2 + ggndv_c*agility2 + ghumv_c*agility2 + gigrcolv_c*agility2 + ginscolv_c*agility2 + gpdiv_c*agility2 + gperv_c*agility2 + guaiv_c*agility2 + I(firmsizestd*firmsizestd) +  (gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c | countryx)
superModel2.fit <- blmer(superModel2, data = CultureData, REML = FALSE, control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun = 1e+05)), verbose = TRUE)
superModel2 <- outcome ~ firmsizestd + gmci2016c + gassv_c + gfuov_c + ggndv_c + ghumv_c + gigrcolv_c + ginscolv_c + gpdiv_c + gperv_c + guaiv_c + agility2 + gassv_c*agility2 + gfuov_c*agility2 + ggndv_c*agility2 + ghumv_c*agility2 + gigrcolv_c*agility2 + ginscolv_c*agility2 + gpdiv_c*agility2 + gperv_c*agility2 + guaiv_c*agility2 + I(firmsizestd*firmsizestd)
superModel.lm.fit <- lm(superModel2, data = CultureData)
summary(superModel.lm.fit)
